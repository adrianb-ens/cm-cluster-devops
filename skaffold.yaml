apiVersion: skaffold/v2beta10
kind: Config
build:
  artifacts:
    - image: radiantone/eoc-ui
      context: ./src/cloudmanager-ui
      docker:
          dockerfile: Dockerfile
      sync:
        infer:
            - "*.js"
            - "*.html"
            - "**/*.js"
    # - image: cloudmanager-backend
    #   context: ./src/cloudmanager-backend
    #   docker:
    #       dockerfile: Dockerfile
    #   sync:
    #     infer:
    #         - "*.js"
    #         - "*.html"
    #         - "**/*.js"
deploy:
  helm:
    releases:
      - name: eoc-ui
        chartPath: ./helm/ui
        artifactOverrides: 
          eoc-ui.image: radiantone/eoc-ui
        setValueTemplates:
          image.repository: "{{.IMAGE_REPO_radiantone_eoc_ui}}"
          image.tag: "{{.IMAGE_TAG_radiantone_eoc_ui}}"
  # kubectl:
  #   # defaultNamespace: svc
  #   manifests:
  #     - "./kubernetes/cloudmanager-ui.yaml"
  #     - "./kubernetes/cloudmanager-backend.yaml"
portForward:
  - resourceType: service
    resourceName: eoc-ui-service
    port: 80
    localPort: 3000
  # - resourceType: service
  #   resourceName: cloudmanager-backend-service
  #   port: 80
  #   localPort: 3001